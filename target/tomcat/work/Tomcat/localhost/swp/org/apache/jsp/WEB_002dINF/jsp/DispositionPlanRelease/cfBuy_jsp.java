/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2018-08-30 02:34:47 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsp.DispositionPlanRelease;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class cfBuy_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			"", true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');

    String appPath=request.getContextPath();
    String ticketId = (String)request.getAttribute("ticketId");

      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/user_top.jsp" + "?" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("title", request.getCharacterEncoding())+ "=" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("我的易废圈", request.getCharacterEncoding()), out, true);
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/wasteCircleMenu.jsp" + "?" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("menuId", request.getCharacterEncoding())+ "=" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("#myIndex", request.getCharacterEncoding()), out, true);
      out.write("\r\n");
      out.write("<link rel=\"stylesheet\" href=\"");
      out.print(appPath );
      out.write("/thirdparty/sweetalert/dist/sweetalert.css?1\">\r\n");
      out.write("<link rel=\"stylesheet\" href=\"");
      out.print(appPath);
      out.write("/main/common/elementui/index.css\">\r\n");
      out.write("<link rel=\"stylesheet\" href=\"");
      out.print(appPath);
      out.write("/main/pc/css/publish.css?2\">\r\n");
      out.write("\r\n");
      out.write("<section>\r\n");
      out.write("    <div class=\"el-breadcrumb\">\r\n");
      out.write("        <span class=\"el-breadcrumb__item\">\r\n");
      out.write("            <span class=\"el-breadcrumb__item__inner\" onclick=\"history.go(-1);\">");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${breadcrumbName}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("</span>\r\n");
      out.write("            <span class=\"el-breadcrumb__separator\">/</span>\r\n");
      out.write("        </span>\r\n");
      out.write("        <span class=\"el-breadcrumb__item\">\r\n");
      out.write("            <span class=\"el-breadcrumb__item__inner\">报价</span>\r\n");
      out.write("            <span class=\"el-breadcrumb__separator\">/</span>\r\n");
      out.write("        </span>\r\n");
      out.write("    </div>\r\n");
      out.write("    <div class=\"panel panel-body\">\r\n");
      out.write("        <div id=\"app\">\r\n");
      out.write("            <template>\r\n");
      out.write("                <div class=\"buy_con panel panel-body\" style=\"margin-bottom: 0\">\r\n");
      out.write("                    <el-row :gutter=\"10\" style=\"margin-bottom:10px\">\r\n");
      out.write("                        <el-col :xs=\"17\" :sm=\"17\" :md=\"17\" :lg=\"17\">{{entName}}<span class=\"split\">|</span><b>总计：</b><font>{{tableData.length}}</font>种危废，累计<font>{{totalWasteAmountDesc}}</font></el-col>\r\n");
      out.write("                        <el-col :xs=\"7\" :sm=\"7\" :md=\"7\" :lg=\"7\" align=\"right\" style=\"font-size:12px\"><i class=\"time_icon\"></i>发布于{{releaseDate}}</el-col>\r\n");
      out.write("                    </el-row>\r\n");
      out.write("                    <el-table :data=\"tableData\" border v-loading.body=\"listLoading\" ref=\"dataSelectTable\"\r\n");
      out.write("                              @selection-change=\"handleSelectionChange\"\r\n");
      out.write("                              style=\"width:100%\">\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                type=\"selection\"\r\n");
      out.write("                                width=\"75\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"危废名称\"\r\n");
      out.write("                                width=\"180\"\r\n");
      out.write("                                prop=\"wasteName\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"危废代码\"\r\n");
      out.write("                                width=\"130px\"\r\n");
      out.write("                                prop=\"wasteCode\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"数量\"\r\n");
      out.write("                                align=\"right\"\r\n");
      out.write("                                prop=\"wasteAmount\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"单位\"\r\n");
      out.write("                                prop=\"unitValue\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        ");
      out.write("\r\n");
      out.write("                    </el-table>\r\n");
      out.write("                    ");
      out.write("\r\n");
      out.write("                        ");
      out.write("\r\n");
      out.write("                    ");
      out.write("\r\n");
      out.write("                    ");
      out.write("\r\n");
      out.write("                        ");
      out.write("\r\n");
      out.write("                    ");
      out.write("\r\n");
      out.write("                </div>\r\n");
      out.write("                <div v-show=\"multipleSelection.length>0\" class=\"panel panel-body\" style=\"margin: 1px 15px\" id=\"selectionTable\">\r\n");
      out.write("                    <div class=\"title\">报价单</div>\r\n");
      out.write("                    <el-table :data=\"multipleSelection\"\r\n");
      out.write("                              v-loading=\"publishLoading\"\r\n");
      out.write("                              element-loading-text=\"正在报价中\" border\r\n");
      out.write("                              style=\"width:100%\">\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                prop=\"wasteName\"\r\n");
      out.write("                                label=\"危废名称\" width=\"180px\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                prop=\"wasteCode\"\r\n");
      out.write("                                width=\"130px\"\r\n");
      out.write("                                label=\"危废代码\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                prop=\"wasteAmount\"\r\n");
      out.write("                                align=\"right\"\r\n");
      out.write("                                label=\"数量\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"单位\"\r\n");
      out.write("                                prop=\"unitValue\">\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                prop=\"price\"\r\n");
      out.write("                                align=\"right\"\r\n");
      out.write("                                v-if=\"buyType==2\"\r\n");
      out.write("                                label=\"单价\">\r\n");
      out.write("                            <template scope=\"scope\">\r\n");
      out.write("                                <el-input placeholder=\"请输入单价\" v-model=\"multipleSelection[scope.$index]['price']\"></el-input>\r\n");
      out.write("                            </template>\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column\r\n");
      out.write("                                label=\"单项总价\"\r\n");
      out.write("                                v-if=\"buyType==2\"\r\n");
      out.write("                                prop=\"totalPrice\">\r\n");
      out.write("                            <template scope=\"scope\">\r\n");
      out.write("                                <span  style=\"color: #ff0000;\">{{getOneToTalPrice(multipleSelection[scope.$index]['price'],multipleSelection[scope.$index]['wasteAmount'])}}</span>\r\n");
      out.write("                            </template>\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <el-table-column label=\"操作\" width=\"100px\" prop=\"entWasteId\">\r\n");
      out.write("                            <template scope=\"scope\">\r\n");
      out.write("                                <el-button type=\"text\" title=\"删除\" @click.native.prevent=\"deleteRow(scope.$index,multipleSelection)\">删除</el-button>\r\n");
      out.write("                            </template>\r\n");
      out.write("                        </el-table-column>\r\n");
      out.write("                        <div slot=\"append\" class=\"sum\">\r\n");
      out.write("                            <span>合计：</span>您将报价<font>{{multipleSelection.length}}</font>种危废，累计<font>{{getQualityTextBySelection()}}</font>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div slot=\"append\" class=\"sum\">\r\n");
      out.write("                            <div class=\"totalPriceMessage\">\r\n");
      out.write("                                <label style=\"color: #6b7580\">总价：</label>\r\n");
      out.write("                                <input class=\"form-control\" placeholder=\"请输入打包总价\" id=\"totalAmount\" v-show=\"buyType==1\"/>\r\n");
      out.write("                                <span v-show=\"buyType==2\" class=\"totalText\">{{getTotalPrice()}}</span>\r\n");
      out.write("                                ");
      out.write("\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <span>报价：</span>\r\n");
      out.write("                            <template>\r\n");
      out.write("                                <el-radio class=\"radio\" v-model=\"radio\" label=\"1\" id=\"1\">打包报价</el-radio>\r\n");
      out.write("                                <el-radio class=\"radio\" v-model=\"radio\" label=\"2\" id=\"2\">单独报价</el-radio>\r\n");
      out.write("                            </template>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div slot=\"append\" class=\"sum\">\r\n");
      out.write("                            <span>备注：</span>\r\n");
      out.write("                            <el-input type=\"textarea\" style=\"width: 700px\" v-model=\"remark\" placeholder=\"请填写运费合算方式及包装方式，如：价格包含运费，放在吨袋里面独立包装\"></el-input>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div slot=\"append\" class=\"sum\" style=\"width: 910px\" align=\"center\">\r\n");
      out.write("                            <el-button type=\"primary\" @click=\"submit\" :loading=\"submitLoading\" class=\"quote-btn\">报价</el-button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </el-table>\r\n");
      out.write("                </div>\r\n");
      out.write("            </template>\r\n");
      out.write("        </div>\r\n");
      out.write("        </body>\r\n");
      out.write("        <!-- 先引入 Vue -->\r\n");
      out.write("        <script src=\"");
      out.print(appPath);
      out.write("/main/common/elementui/vue.min.js\"></script>\r\n");
      out.write("        <!-- 引入组件库 -->\r\n");
      out.write("        <script src=\"");
      out.print(appPath);
      out.write("/main/common/elementui/index.js\"></script>\r\n");
      out.write("        <script src=\"");
      out.print(appPath );
      out.write("/app/js/constants.js\"></script>\r\n");
      out.write("        <script src=\"");
      out.print(appPath );
      out.write("/thirdparty/sweetalert/dist/sweetalert.min.js?1\"></script>\r\n");
      out.write("        <script src=\"");
      out.print(appPath );
      out.write("/thirdparty/la-number/la-number.js\"></script>\r\n");
      out.write("        <script>\r\n");
      out.write("\r\n");
      out.write("            var vue=new Vue({\r\n");
      out.write("                el: '#app',\r\n");
      out.write("                data: {\r\n");
      out.write("                    tableData: [],\r\n");
      out.write("                    listLoading:true,\r\n");
      out.write("                    multipleSelection:[],\r\n");
      out.write("                    wasteSelected:false,\r\n");
      out.write("                    publishLoading:false,\r\n");
      out.write("                    dialogVisible:false,\r\n");
      out.write("                    totalQtyText:'0吨',\r\n");
      out.write("                    remark:'',\r\n");
      out.write("                    buyType:'1',\r\n");
      out.write("                    entName:'',\r\n");
      out.write("                    totalWasteAmountDesc:'',\r\n");
      out.write("                    releaseDate:'',\r\n");
      out.write("                    radio:'1',\r\n");
      out.write("                    releaseRemark:'',\r\n");
      out.write("                    info:{},\r\n");
      out.write("                    totalAmount:0,\r\n");
      out.write("                    activityId:getParam('activityId'),\r\n");
      out.write("                    submitLoading:false,\r\n");
      out.write("                    facilitatorEntId:getParam('facilitatorEntId')||''\r\n");
      out.write("                },\r\n");
      out.write("                created:function() {\r\n");
      out.write("                    this.getList();\r\n");
      out.write("                },\r\n");
      out.write("                mounted:function () {\r\n");
      out.write("                    var _this=this;\r\n");
      out.write("                    $('.el-radio.radio').click(function () {\r\n");
      out.write("                        $(this).find('.el-radio__input').addClass('is-checked');\r\n");
      out.write("                        $(this).siblings().find('.el-radio__input').removeClass('is-checked');\r\n");
      out.write("                        vue.buyType=$(this).attr('id');\r\n");
      out.write("                        return false;\r\n");
      out.write("                    });\r\n");
      out.write("                    Vue.nextTick(function () {\r\n");
      out.write("                        $('.cell:first').append('<span style=\"margin-left: 4px;font-size: 12px;font-weight: 100;\">全选</span>')\r\n");
      out.write("                    });\r\n");
      out.write("                },\r\n");
      out.write("                methods:{\r\n");
      out.write("                    getList:function () {\r\n");
      out.write("                        this.listLoading = true;\r\n");
      out.write("                        var _this=this;\r\n");
      out.write("                        ajax({\r\n");
      out.write("                            url:'/entReleaseDetail/listReleaseDetail.htm',\r\n");
      out.write("                            dataType:'json',\r\n");
      out.write("                            data:{\r\n");
      out.write("                                releaseId:getParam('releaseId')\r\n");
      out.write("                            },\r\n");
      out.write("                            success:function (result) {\r\n");
      out.write("                                console.log(result);\r\n");
      out.write("                                _this.listLoading = false;\r\n");
      out.write("                                if(result.status==1&&result.data){\r\n");
      out.write("                                    var releaseWasteDetails=result.data.releaseWasteDetails;\r\n");
      out.write("                                    _this.entName=result.data.entName;\r\n");
      out.write("                                    _this.totalWasteAmountDesc=result.data.totalWasteAmountDesc;\r\n");
      out.write("                                    _this.releaseRemark=result.data.releaseRemark;\r\n");
      out.write("                                    _this.releaseDate=result.data.releaseDate.substring(0,7);\r\n");
      out.write("                                    for(var i in releaseWasteDetails){\r\n");
      out.write("                                        releaseWasteDetails[i].status=0;\r\n");
      out.write("                                        releaseWasteDetails[i].price=0;\r\n");
      out.write("                                        releaseWasteDetails[i].totalPrice=0;\r\n");
      out.write("                                        releaseWasteDetails[i].index=i;\r\n");
      out.write("                                    }\r\n");
      out.write("                                    _this.tableData=releaseWasteDetails;\r\n");
      out.write("                                    _this.info=result.data;\r\n");
      out.write("                                }\r\n");
      out.write("                            }\r\n");
      out.write("                        })\r\n");
      out.write("                    },\r\n");
      out.write("                    submit:function () {\r\n");
      out.write("                        this.submitLoading=true;\r\n");
      out.write("                        var totalAmount=$('#totalAmount').val();\r\n");
      out.write("                        var param={\r\n");
      out.write("                            releaseEntId:this.info.releaseEntId,//发布企业Id\r\n");
      out.write("                            releaseId:this.info.releaseId,//发布Id\r\n");
      out.write("                            quotedType:this.buyType*1-1,//报价类型\r\n");
      out.write("                            totalAmount:this.totalQtyText,//总量\r\n");
      out.write("                            totalPrice:this.buyType=='1'?totalAmount:this.totalAmount,//总价\r\n");
      out.write("                            remark:this.remark,//备注\r\n");
      out.write("                        };\r\n");
      out.write("                        if(this.activityId){\r\n");
      out.write("                            param.activityId=this.activityId;\r\n");
      out.write("                        }\r\n");
      out.write("                        if(this.facilitatorEntId){\r\n");
      out.write("                            param.facilitatorEntId=this.facilitatorEntId;\r\n");
      out.write("                        }\r\n");
      out.write("                        var inquiryDetail=[];\r\n");
      out.write("                        var laNumber = new $.LaNumber();\r\n");
      out.write("                        var pattern=/^(?=([0-9]{1,10}$|[0-9]{1,7}\\.))(0|[1-9][0-9]*)(\\.[0-9]{1,3})?$/;\r\n");
      out.write("                        var priceFlag=true;\r\n");
      out.write("                        for(var i in this.multipleSelection){\r\n");
      out.write("                            var obj=this.multipleSelection[i];\r\n");
      out.write("                            var o={};\r\n");
      out.write("                            o.releaseDetailId=obj['detailId'];\r\n");
      out.write("                            if(this.buyType=='1'){\r\n");
      out.write("                                o.price=0;\r\n");
      out.write("                                o.totalPrice=0;\r\n");
      out.write("                            }else{\r\n");
      out.write("                                o.price=parseFloat(obj['price']);\r\n");
      out.write("                                o.totalPrice=laNumber.mul(obj['price'],obj['wasteAmount']);\r\n");
      out.write("                                if(!pattern.test(o.price)||o.price==0){\r\n");
      out.write("                                    priceFlag=false;\r\n");
      out.write("                                }\r\n");
      out.write("                            }\r\n");
      out.write("                            inquiryDetail.push(o);\r\n");
      out.write("                        }\r\n");
      out.write("                        if(this.buyType=='1'&&(!pattern.test(totalAmount)||totalAmount=='0')||this.buyType=='2'&&!priceFlag){\r\n");
      out.write("                            $.notify('价格必须是不为0的正数，总长不超过十位,最多三位小数',{status:'info',timeout:2500});\r\n");
      out.write("                            this.submitLoading=false;\r\n");
      out.write("                            return;\r\n");
      out.write("                        }\r\n");
      out.write("                        param['inquiryDetail']=inquiryDetail;\r\n");
      out.write("                        console.log(param);\r\n");
      out.write("                        ajax({\r\n");
      out.write("                            url:'/entInquiry/saveEntInquiry.htm?ticketId='+getParam('ticketId'),\r\n");
      out.write("                            data:JSON.stringify(param),\r\n");
      out.write("                            dataType:'json',\r\n");
      out.write("                            contentType:'application/json',\r\n");
      out.write("                            success:function (result) {\r\n");
      out.write("                                console.log(result);\r\n");
      out.write("                                if(result.status==1&&result.data){\r\n");
      out.write("                                    var str='");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${breadcrumbName}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("';\r\n");
      out.write("//                                    $.notify('报价成功,3秒后将返回'+str+'...',{status:'success',timeout:3000});\r\n");
      out.write("                                    collectingUserBehavior(getParam('ticketId'),'INQUIRY');\r\n");
      out.write("                                    swal({\r\n");
      out.write("                                        title: \"报价成功!\",\r\n");
      out.write("                                        text: \"你可在我的报价中查看产废企业回复\",\r\n");
      out.write("                                        type: \"success\",\r\n");
      out.write("                                        confirmButtonColor: \"#1171d1\",\r\n");
      out.write("                                        closeOnConfirm: true,\r\n");
      out.write("                                        confirmButtonText: \"知道了\"\r\n");
      out.write("                                    },\r\n");
      out.write("                                    function(){\r\n");
      out.write("                                        goBack();\r\n");
      out.write("                                    });\r\n");
      out.write("                                    ");
      out.write("\r\n");
      out.write("                                        ");
      out.write("\r\n");
      out.write("                                            ");
      out.write("\r\n");
      out.write("                                        ");
      out.write("\r\n");
      out.write("                                            ");
      out.write("\r\n");
      out.write("                                        ");
      out.write("\r\n");
      out.write("                                    ");
      out.write("\r\n");
      out.write("                                }else{\r\n");
      out.write("                                    this.submitLoading=false;\r\n");
      out.write("                                }\r\n");
      out.write("                            },\r\n");
      out.write("                            error:function () {\r\n");
      out.write("                                this.submitLoading=false;\r\n");
      out.write("                            }\r\n");
      out.write("                        })\r\n");
      out.write("                    },\r\n");
      out.write("                    handleSelectionChange:function (val) {\r\n");
      out.write("                        this.multipleSelection=val;\r\n");
      out.write("                    },\r\n");
      out.write("                    join:function (index, rows) {\r\n");
      out.write("                        rows[index]['status']=1;\r\n");
      out.write("                        this.multipleSelection.push(rows[index]);\r\n");
      out.write("                    },\r\n");
      out.write("                    deleteRow:function(index, rows) {\r\n");
      out.write("                        var i=rows[index][\"index\"];\r\n");
      out.write("                        this.$refs.dataSelectTable.toggleRowSelection(this.tableData[i]);\r\n");
      out.write("                    },\r\n");
      out.write("                    getTotalPrice:function () {\r\n");
      out.write("                        var arr=this.multipleSelection;\r\n");
      out.write("                        var totalPrice=0;\r\n");
      out.write("                        var laNumber = new $.LaNumber();\r\n");
      out.write("                        for(var i in arr) {\r\n");
      out.write("                            var value=laNumber.mul(arr[i]['wasteAmount'],arr[i]['price']);\r\n");
      out.write("                            totalPrice=laNumber.add(totalPrice,value);\r\n");
      out.write("                        }\r\n");
      out.write("                        this.totalAmount=totalPrice;\r\n");
      out.write("                        return fmoney(totalPrice,2)+'元';\r\n");
      out.write("                    },\r\n");
      out.write("                    getOneToTalPrice:function (price,qty) {\r\n");
      out.write("                        var laNumber = new $.LaNumber();\r\n");
      out.write("                        return laNumber.mul(price,qty);\r\n");
      out.write("                    },\r\n");
      out.write("                    getQualityTextBySelection:function() {\r\n");
      out.write("                        var arr=this.multipleSelection;\r\n");
      out.write("                        var obj = {};\r\n");
      out.write("                        var laNumber = new $.LaNumber();\r\n");
      out.write("                        for(var i in arr) {\r\n");
      out.write("                            var key = arr[i]['unitValue'];\r\n");
      out.write("                            var value = parseFloat(arr[i]['wasteAmount']);\r\n");
      out.write("                            if(key=='吨'||key=='千克'||key=='克'){\r\n");
      out.write("                                switch (key){\r\n");
      out.write("                                    case '千克':\r\n");
      out.write("                                        value=laNumber.div(value,1000);\r\n");
      out.write("                                        break;\r\n");
      out.write("                                    case '克':\r\n");
      out.write("                                        value=laNumber.div(value,1000000);\r\n");
      out.write("                                        break;\r\n");
      out.write("                                }\r\n");
      out.write("                                if(obj['吨']){\r\n");
      out.write("                                    obj['吨']=laNumber.add(obj['吨'],value);\r\n");
      out.write("                                }else{\r\n");
      out.write("                                    obj['吨']=value;\r\n");
      out.write("                                }\r\n");
      out.write("                            }else{\r\n");
      out.write("                                if(obj[key]) {\r\n");
      out.write("                                    obj[key] =laNumber.add(obj[key],value) ;\r\n");
      out.write("                                } else {\r\n");
      out.write("                                    obj[key] = value;\r\n");
      out.write("                                }\r\n");
      out.write("                            }\r\n");
      out.write("                        }\r\n");
      out.write("                        var str='';\r\n");
      out.write("                        for (var prop in obj) {\r\n");
      out.write("                            str+=obj[prop]+prop+'，';\r\n");
      out.write("                        }\r\n");
      out.write("                        str=str.substring(0,str.length-1);\r\n");
      out.write("                        this.totalQtyText=str;\r\n");
      out.write("                        return str;\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("            });\r\n");
      out.write("            function goBack() {\r\n");
      out.write("                document.cookie=\"index=true;path=");
      out.print(appPath);
      out.write("/wastecircle/\";\r\n");
      out.write("                window.history.go(-1);\r\n");
      out.write("            }\r\n");
      out.write("        </script>\r\n");
      out.write("    </div>\r\n");
      out.write("</section>\r\n");
      out.write("\r\n");
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/bottom.jsp", out, true);
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("    $(document).ready(function() {\r\n");
      out.write("        var rs = window.globalInit();\r\n");
      out.write("        rs.done(function () {\r\n");
      out.write("//            init();\r\n");
      out.write("        });\r\n");
      out.write("//        $('.sum').width($('.sum').parent().parent().width()-60+'px');\r\n");
      out.write("//        window.onresize=function () {\r\n");
      out.write("//            $('.sum').width($('.sum').parent().parent().width()-60+'px');\r\n");
      out.write("//        }\r\n");
      out.write("\r\n");
      out.write("    });\r\n");
      out.write("</script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
