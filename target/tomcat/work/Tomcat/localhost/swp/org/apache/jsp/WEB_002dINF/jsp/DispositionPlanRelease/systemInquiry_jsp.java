/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.47
 * Generated at: 2018-08-29 05:10:40 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.WEB_002dINF.jsp.DispositionPlanRelease;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class systemInquiry_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			"", true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');

    String appPath=request.getContextPath();
    String ticketId = (String)request.getAttribute("ticketId");
    String releaseId = (String)request.getAttribute("releaseId");

      out.write('\r');
      out.write('\n');
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/user_top.jsp" + "?" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("title", request.getCharacterEncoding())+ "=" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("我的易废圈", request.getCharacterEncoding()), out, true);
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/wasteCircleMenu.jsp" + "?" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("menuId", request.getCharacterEncoding())+ "=" + org.apache.jasper.runtime.JspRuntimeLibrary.URLEncode("#myIndex", request.getCharacterEncoding()), out, true);
      out.write("\r\n");
      out.write("<link rel=\"stylesheet\" href=\"");
      out.print(appPath);
      out.write("/main/common/elementui/index.css\">\r\n");
      out.write("<link rel=\"stylesheet\" href=\"");
      out.print(appPath);
      out.write("/main/pc/css/publish.css?7\">\r\n");
      out.write("\r\n");
      out.write("<section id=\"app\">\r\n");
      out.write("    <template>\r\n");
      out.write("    <el-breadcrumb separator=\"/\">\r\n");
      out.write("        <el-breadcrumb-item onclick=\"vue.back();\">危废处置询价</el-breadcrumb-item>\r\n");
      out.write("        <el-breadcrumb-item>系统参考报价</el-breadcrumb-item>\r\n");
      out.write("    </el-breadcrumb>\r\n");
      out.write("    <div class=\"panel panel-body\">\r\n");
      out.write("        <div class=\"panel panel-body\">\r\n");
      out.write("            ");
      out.write("\r\n");
      out.write("            <div class=\"success-title\" v-if=\"systemInquiry\"><i class=\"el-icon-circle-check-outline\"></i>感谢你的询价，系统给出的参考报价为:</div>\r\n");
      out.write("            <div class=\"success-title\" style=\"margin-bottom: 85px\" v-else><i class=\"el-icon-warning\"></i>您发布的危废暂未匹配到合适的报价，工作人员将在2小时内为您提供人工报价，请耐心等待！</div>\r\n");
      out.write("            <table class=\"el-table inquiry-table\" v-if=\"systemInquiry\">\r\n");
      out.write("                <tr>\r\n");
      out.write("                    <th class=\"is-center\">序号</th>\r\n");
      out.write("                    <th>危废名称</th>\r\n");
      out.write("                    <th>危废代码</th>\r\n");
      out.write("                    <th class=\"is-right\">处置重量</th>\r\n");
      out.write("                    <th class=\"is-center\">处置方式</th>\r\n");
      out.write("                    <th class=\"is-right\">处置单价</th>\r\n");
      out.write("                    <th class=\"is-right\">单项总价</th>\r\n");
      out.write("                    <th  class=\"is-center\">价格说明</th>\r\n");
      out.write("                </tr>\r\n");
      out.write("                <tr v-if=\"systemInquiryList.length>0\" v-for=\"(item,index) in systemInquiryList\">\r\n");
      out.write("                    <td  class=\"is-center\">\r\n");
      out.write("                        {{index+1}}\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td>\r\n");
      out.write("                        {{item.wasteName}}\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td>\r\n");
      out.write("                        {{item.wasteCode}}\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td class=\"is-right\">\r\n");
      out.write("                        {{parseFloat(item.amount)+item.unitValue}}\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td v-if=\"item.first\" :rowspan=\"priceIdCountObj[item.priceId]\" class=\"is-center\">\r\n");
      out.write("                        {{item.dispositionType}}\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td v-if=\"item.first\" class=\"is-right\" :rowspan=\"priceIdCountObj[item.priceId]\">\r\n");
      out.write("                        <span style=\"color: #ff0000;\">￥{{item.price}}{{['吨','千克','克'].indexOf(item.unitValue)>-1?'/吨':''}}</span>\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td v-if=\"item.first\" class=\"is-right\" :rowspan=\"priceIdCountObj[item.priceId]\">\r\n");
      out.write("                        <span style=\"color: #ff0000;\">￥{{item.wasteTotalPrice}}</span>\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td v-if=\"item.first\" :rowspan=\"priceIdCountObj[item.priceId]\" class=\"is-center\">\r\n");
      out.write("                        <el-tooltip effect=\"dark\" v-if=\"item.remark\" :content=\"item.remark\" placement=\"top-start\">\r\n");
      out.write("                            <i class=\"el-icon-question\"></i>\r\n");
      out.write("                        </el-tooltip>\r\n");
      out.write("                        <span v-else>--</span>\r\n");
      out.write("                    </td>\r\n");
      out.write("                </tr>\r\n");
      out.write("                <tr>\r\n");
      out.write("                    <td class=\"is-center\">总计</td>\r\n");
      out.write("                    <td colspan=\"2\"></td>\r\n");
      out.write("                    <td class=\"is-right\">\r\n");
      out.write("                        <b style=\"color:#1171d1;\">{{getQualityTextBySelection}}</b>\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td colspan=\"2\"></td>\r\n");
      out.write("                    <td class=\"is-right\">\r\n");
      out.write("                        <b style=\"color:#ff484d\">￥{{systemInquiry.totalPriceStr}}</b>\r\n");
      out.write("                    </td>\r\n");
      out.write("                    <td></td>\r\n");
      out.write("                </tr>\r\n");
      out.write("            </table>\r\n");
      out.write("            <div class=\"success-title\" v-if=\"noneInquiryList&&noneInquiryList.length>0\" style=\"margin: 30px 0 10px;font-size: 15px;\">下列危废系统暂时无法给出报价:（具体情况，工作人员会跟您取得联系）</div>\r\n");
      out.write("            <el-table\r\n");
      out.write("                    v-if=\"noneInquiryList.length>0\"\r\n");
      out.write("                    :data=\"noneInquiryList\"\r\n");
      out.write("                    border\r\n");
      out.write("                    style=\"width: 100%; \">\r\n");
      out.write("                <el-table-column\r\n");
      out.write("                        type=\"index\"\r\n");
      out.write("                        width=\"50px\"\r\n");
      out.write("                        align=\"center\"\r\n");
      out.write("                        label=\"序号\">\r\n");
      out.write("                </el-table-column>\r\n");
      out.write("                <el-table-column\r\n");
      out.write("                        prop=\"wasteName\"\r\n");
      out.write("                        label=\"危废名称\">\r\n");
      out.write("                </el-table-column>\r\n");
      out.write("                <el-table-column\r\n");
      out.write("                        prop=\"wasteCode\"\r\n");
      out.write("                        width=\"100px\"\r\n");
      out.write("                        label=\"危废代码\">\r\n");
      out.write("                </el-table-column>\r\n");
      out.write("                <el-table-column\r\n");
      out.write("                        prop=\"qty\"\r\n");
      out.write("                        align=\"right\"\r\n");
      out.write("                        label=\"处置重量\">\r\n");
      out.write("                    <template scope=\"scope\">\r\n");
      out.write("                        {{parseFloat(scope.row.amount)+scope.row.unitValue}}\r\n");
      out.write("                    </template>\r\n");
      out.write("                </el-table-column>\r\n");
      out.write("            </el-table>\r\n");
      out.write("            <div class=\"desc\" >\r\n");
      out.write("                <p>说明：</p>\r\n");
      out.write("                <p>\r\n");
      out.write("                    ");
      out.write("\r\n");
      out.write("                    1、此报价不是最终报价，最终报价需参考化验结果,以最终危险废物处置合同为准。<br/>\r\n");
      out.write("                    2、如需帮助，请拨打：0512-62717018<br/>\r\n");
      out.write("                </p>\r\n");
      out.write("            </div>\r\n");
      out.write("                <div align=\"center\" style=\"margin-top: 20px\">\r\n");
      out.write("                    <span>满足环保要求、避免处罚风险、规范管理危废</br>\r\n");
      out.write("                    小易向你推荐管家服务</span>\r\n");
      out.write("                </div>\r\n");
      out.write("            <div align=\"center\" style=\"margin-top: 20px\">\r\n");
      out.write("                <el-button type=\"primary\" style=\"background-color:#ff8700;border-color:#ff8700; \" @click=\"viewService\">了解管家服务></el-button>\r\n");
      out.write("                ");
      out.write("\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("        </div>\r\n");
      out.write("    </div>\r\n");
      out.write("    </template>\r\n");
      out.write("</section>\r\n");
      out.write("<!-- 先引入 Vue -->\r\n");
      out.write("<script src=\"");
      out.print(appPath);
      out.write("/main/common/elementui/vue.min.js\"></script>\r\n");
      out.write("<!-- 引入组件库 -->\r\n");
      out.write("<script src=\"");
      out.print(appPath);
      out.write("/main/common/elementui/index.js\"></script>\r\n");
      out.write("<script src=\"");
      out.print(appPath );
      out.write("/app/js/constants.js\"></script>\r\n");
      out.write("<script src=\"");
      out.print(appPath );
      out.write("/thirdparty/la-number/la-number.js\"></script>\r\n");
      out.write("<script>\r\n");
      out.write("    var vue=new Vue({\r\n");
      out.write("        el: '#app',\r\n");
      out.write("        data: {\r\n");
      out.write("            releaseId:getParam('releaseId')||'',\r\n");
      out.write("            informEntCount:getParam('informEntCount')||0,\r\n");
      out.write("            systemInquiry:'',\r\n");
      out.write("            systemInquiryList:[],\r\n");
      out.write("            priceIdCountObj:{},\r\n");
      out.write("            quotationList: [],\r\n");
      out.write("            dispositionTypeList:[{code:'D10',value:'焚烧'},{code:'R9',value:'利用'}],\r\n");
      out.write("            dispositionTypeObj:{},\r\n");
      out.write("            totalQtyT:0,\r\n");
      out.write("            totalQtyText:'',\r\n");
      out.write("            noneInquiryList:[]\r\n");
      out.write("        },\r\n");
      out.write("        created:function() {\r\n");
      out.write("            this.getSystemInquiry();\r\n");
      out.write("            const h = this.$createElement;\r\n");
      out.write("            this.$msgbox( {\r\n");
      out.write("                title: '提示',\r\n");
      out.write("                message:h('p', null, [\r\n");
      out.write("                    h('span', null, '小易已经通知区域内的'),\r\n");
      out.write("                    h('span', { style: 'color: red' }, this.informEntCount+'家'),\r\n");
      out.write("                    h('span', null, '处置经营企业前来报价，请随时关注平台信息和短信。'),\r\n");
      out.write("                    h('br', null),\r\n");
      out.write("                    h('span','如急需处置，请直接拨打易废网电话：'),\r\n");
      out.write("                    h('span', { style: 'color: red' }, '0512-62717018。')\r\n");
      out.write("                ]),\r\n");
      out.write("                confirmButtonText: '知道了',\r\n");
      out.write("                confirmButtonClass:'confirm'\r\n");
      out.write("            });\r\n");
      out.write("        },\r\n");
      out.write("        mounted:function () {\r\n");
      out.write("            var _this=this;\r\n");
      out.write("            this.dispositionTypeList.forEach(function (item) {\r\n");
      out.write("                _this.dispositionTypeObj[item.code]=item.value;\r\n");
      out.write("            })\r\n");
      out.write("        },\r\n");
      out.write("        computed:{\r\n");
      out.write("            getQualityTextBySelection:function () {\r\n");
      out.write("                if(!this.systemInquiry){\r\n");
      out.write("                    return;\r\n");
      out.write("                }\r\n");
      out.write("                var arr=this.systemInquiry.inquiryDetail;\r\n");
      out.write("                var obj = {};\r\n");
      out.write("                var laNumber = new $.LaNumber();\r\n");
      out.write("                for(var i in arr) {\r\n");
      out.write("                    var key = arr[i]['unitValue'];\r\n");
      out.write("                    var value = parseFloat(arr[i]['amount']);\r\n");
      out.write("                    if(key=='吨'||key=='千克'||key=='克'){\r\n");
      out.write("                        switch (key){\r\n");
      out.write("                            case '千克':\r\n");
      out.write("                                value=laNumber.div(value,1000);\r\n");
      out.write("                                break;\r\n");
      out.write("                            case '克':\r\n");
      out.write("                                value=laNumber.div(value,1000000);\r\n");
      out.write("                                break;\r\n");
      out.write("                        }\r\n");
      out.write("                        if(obj['吨']){\r\n");
      out.write("                            obj['吨']=laNumber.add(obj['吨'],value);\r\n");
      out.write("                        }else{\r\n");
      out.write("                            obj['吨']=value;\r\n");
      out.write("                        }\r\n");
      out.write("                    }else{\r\n");
      out.write("                        if(obj[key]) {\r\n");
      out.write("                            obj[key] =laNumber.add(obj[key],value) ;\r\n");
      out.write("                        } else {\r\n");
      out.write("                            obj[key] = value;\r\n");
      out.write("                        }\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("                var str='';\r\n");
      out.write("                for (var prop in obj) {\r\n");
      out.write("                    str+=obj[prop]+prop+'，';\r\n");
      out.write("                }\r\n");
      out.write("                str=str.substring(0,str.length-1);\r\n");
      out.write("                return str;\r\n");
      out.write("            }\r\n");
      out.write("        },\r\n");
      out.write("        methods:{\r\n");
      out.write("            viewStep:function () {\r\n");
      out.write("                window.location='");
      out.print(appPath);
      out.write("/introduction.html';\r\n");
      out.write("            },\r\n");
      out.write("            getSystemInquiry:function () {\r\n");
      out.write("                ajax({\r\n");
      out.write("                    url:'/entInquiry/getSystemInquiryByReleaseId.htm',\r\n");
      out.write("                    data:{\r\n");
      out.write("                        releaseId:this.releaseId\r\n");
      out.write("                    },\r\n");
      out.write("                    success:function (result) {\r\n");
      out.write("                        if(result.status==1&&result.data){\r\n");
      out.write("                            var inquiryDetail=result.data.entInquiryModel?result.data.entInquiryModel.inquiryDetail:[];\r\n");
      out.write("                            inquiryDetail.sort(function (o1,o2) {\r\n");
      out.write("                                return o1.priceId>o2.priceId?1:-1;\r\n");
      out.write("                            });\r\n");
      out.write("                            var obj={};\r\n");
      out.write("                            for(var i in inquiryDetail){\r\n");
      out.write("                                var item=inquiryDetail[i];\r\n");
      out.write("                                if(!obj[item.priceId]){\r\n");
      out.write("                                    item.first=true;\r\n");
      out.write("                                    obj[item.priceId]=1;\r\n");
      out.write("                                }else{\r\n");
      out.write("                                    obj[item.priceId]+=1;\r\n");
      out.write("                                }\r\n");
      out.write("                            }\r\n");
      out.write("                            vue.priceIdCountObj=obj;\r\n");
      out.write("                            vue.systemInquiryList=inquiryDetail;\r\n");
      out.write("                            vue.systemInquiry=result.data.entInquiryModel?result.data.entInquiryModel:'';\r\n");
      out.write("                            vue.noneInquiryList=result.data.noneInquiryList;\r\n");
      out.write("                        }\r\n");
      out.write("                    }\r\n");
      out.write("                });\r\n");
      out.write("            },\r\n");
      out.write("            back:function () {\r\n");
      out.write("              window.history.go(-1);\r\n");
      out.write("            },\r\n");
      out.write("            showDispositionTypeEdit:function (index) {\r\n");
      out.write("                var item=this.quotationList[index];\r\n");
      out.write("                item.showDispositionTypeEdit=true;\r\n");
      out.write("                Vue.set(this.quotationList,index,item);\r\n");
      out.write("            },\r\n");
      out.write("            editDispositionType:function (item,index) {\r\n");
      out.write("                $.notify('设置成功',{status:'success',timeout:2500});\r\n");
      out.write("                item.dispositionType=vue.dispositionTypeObj[item.dispositionTypeCode];\r\n");
      out.write("                item.showDispositionTypeEdit=false;\r\n");
      out.write("                Vue.set(vue.quotationList,index,item);\r\n");
      out.write("            },\r\n");
      out.write("            viewService:function () {\r\n");
      out.write("                window.location='");
      out.print(appPath );
      out.write("/wastecircle/init.htm?ticketId=");
      out.print(ticketId );
      out.write("&buyMeal=1';\r\n");
      out.write("            }\r\n");
      out.write("        }\r\n");
      out.write("\r\n");
      out.write("    })\r\n");
      out.write("</script>\r\n");
      out.write('\r');
      out.write('\n');
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "/common/webCommon/bottom.jsp", out, true);
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("    $(document).ready(function() {\r\n");
      out.write("        var rs = window.globalInit();\r\n");
      out.write("        rs.done(function () {\r\n");
      out.write("        });\r\n");
      out.write("    });\r\n");
      out.write("</script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
